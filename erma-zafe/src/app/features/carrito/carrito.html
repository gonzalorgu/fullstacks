<div class="carrito-page">
  <div class="container">
    <!-- Header -->
    <div class="page-header">
      <button class="back-btn" (click)="goBack()">
        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M19 12H5M12 19l-7-7 7-7"/>
        </svg>
        Volver
      </button>
      <h1 class="page-title">Mi Carrito</h1>
      <div class="header-spacer"></div>
    </div>

    @if (items().length === 0) {
      <div class="empty-cart">
        <svg data-icon="bag-1" width="120" height="120" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 48 48" fill="currentColor">
          <path d="M11 44q-1.2 0-2.1-.9Q8 42.2 8 41V15q0-1.2.9-2.1.9-.9 2.1-.9h5.5v-.5q0-3.15 2.175-5.325Q20.85 4 24 4q3.15 0 5.325 2.175Q31.5 8.35 31.5 11.5v.5H37q1.2 0 2.1.9.9.9.9 2.1v26q0 1.2-.9 2.1-.9.9-2.1.9Zm0-3h26V15h-5.5v4.5q0 .65-.425 1.075Q30.65 21 30 21q-.65 0-1.075-.425-.425-.425-.425-1.075V15h-9v4.5q0 .65-.425 1.075Q18.65 21 18 21q-.65 0-1.075-.425-.425-.425-.425-1.075V15H11v26Zm8.5-29h9v-.5q0-1.9-1.3-3.2Q25.9 7 24 7q-1.9 0-3.2 1.3-1.3 1.3-1.3 3.2ZM11 41V15v26Z"/>
        </svg>
        <h2>Tu carrito está vacío</h2>
        <p>Explora nuestro catálogo y agrega vestidos a tu carrito</p>
        <a routerLink="/catalogo" class="btn-primary">Ver catálogo</a>
      </div>
    } @else {
      <div class="cart-content">
        <div class="cart-items">
          @for (item of items(); track item.id) {
            <div class="cart-item">
              <div class="item-image">
                <img [src]="item.imagen" [alt]="item.nombre" />
              </div>
              <div class="item-details">
                <h3 class="item-name">{{ item.nombre }}</h3>
                <div class="item-info">
                  @if (item.talla) { <span class="info-badge">Talla: {{ item.talla }}</span> }
                  @if (item.color) { <span class="info-badge">Color: {{ item.color }}</span> }
                </div>
                <div class="item-dates">
                  <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2" />
                    <line x1="16" y1="2" x2="16" y2="6" />
                    <line x1="8" y1="2" x2="8" y2="6" />
                    <line x1="3" y1="10" x2="21" y2="10" />
                  </svg>
                  <span>{{ item.fechaDesde | date:'dd/MM/yy' }} - {{ item.fechaHasta | date:'dd/MM/yy' }}</span>
                </div>
                <div class="item-price">
                  <span class="price">S/ {{ item.precio }}</span>
                </div>
              </div>
              <button class="remove-btn" (click)="removeItem(item.id)" title="Eliminar">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <polyline points="3 6 5 6 21 6" />
                  <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2" />
                  <line x1="10" y1="11" x2="10" y2="17" />
                  <line x1="14" y1="11" x2="14" y2="17" />
                </svg>
              </button>
            </div>
          }
        </div>
        <div class="order-summary">
          <h2 class="summary-title">Resumen del pedido</h2>
          <div class="summary-details">
            <div class="summary-row">
              <span>Subtotal ({{ items().length }} {{ items().length === 1 ? 'artículo' : 'artículos' }})</span>
              <span class="amount">S/ {{ subtotal() }}</span>
            </div>
            <div class="divider"></div>
            <div class="summary-row total">
              <span>Total</span>
              <span class="amount">S/ {{ total() }}</span>
            </div>
          </div>
          <button class="btn-checkout" (click)="proceedToCheckout()">
            Proceder al pago
            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <line x1="5" y1="12" x2="19" y2="12" />
              <polyline points="12 5 19 12 12 19" />
            </svg>
          </button>
          <button class="btn-clear" (click)="clearCart()">Vaciar carrito</button>
          <div class="security-badge">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" />
            </svg>
            <span>Pago 100% seguro</span>
          </div>
        </div>
      </div>
    }
  </div>
</div>
